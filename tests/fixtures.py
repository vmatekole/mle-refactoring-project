import pandas as pd
import pytest


@pytest.fixture(scope="session")
def house_input_file_path(tmp_path_factory):
    data = pd.DataFrame([{
        "id": "2025069140",
        "date": "3/17/2015",
        "price": 1900000.0,
        "bedrooms": 3,
        "bathrooms": 2.5,
        "sqft_living": 2830,
        "sqft_lot": 4334,
        "floors": 3.0,
        "waterfront": 1.0,
        "view": 4.0,
        "condition": 3,
        "grade": 10,
        "sqft_above": 2830,
        "sqft_basement": 0.0,
        "yr_built": 2006,
        "yr_renovated": 0.0,
        "zipcode": 98074,
        "lat": 47.6318,
        "long": -122.071,
        "sqft_living15": 2830,
        "sqft_lot15": 38211
    },
        {
        "id": "518500480",
        "date": "8/11/2014",
        "price": 3000000.0,
        "bedrooms": 3,
        "bathrooms": 3.5,
        "sqft_living": 4410,
        "sqft_lot": 10756,
        "floors": 2.0,
        "waterfront": 1.0,
        "view": 4.0,
        "condition": 3,
        "grade": 11,
        "sqft_above": 3430,
        "sqft_basement": 980.0,
        "yr_built": 2014,
        "yr_renovated": 0.0,
        "zipcode": 98056,
        "lat": 47.5283,
        "long": -122.205,
        "sqft_living15": 3550,
        "sqft_lot15": 5634
    },
        {
        "id": "8043700105",
        "date": "4/17/2015",
        "price": 2300000.0,
        "bedrooms": 4,
        "bathrooms": 4.0,
        "sqft_living": 4360,
        "sqft_lot": 8175,
        "floors": 2.5,
        "waterfront": 1.0,
        "view": 4.0,
        "condition": 3,
        "grade": 10,
        "sqft_above": 3940,
        "sqft_basement": 420.0,
        "yr_built": 2007,
        "yr_renovated": 0.0,
        "zipcode": 98008,
        "lat": 47.5724,
        "long": -122.104,
        "sqft_living15": 2670,
        "sqft_lot15": 8525
    },
        {
        "id": "9253900271",
        "date": "1/7/2015",
        "price": 3570000.0,
        "bedrooms": 5,
        "bathrooms": 4.5,
        "sqft_living": 4850,
        "sqft_lot": 10584,
        "floors": 2.0,
        "waterfront": 1.0,
        "view": 4.0,
        "condition": 3,
        "grade": 10,
        "sqft_above": 3540,
        "sqft_basement": 1310.0,
        "yr_built": 2007,
        "yr_renovated": 0.0,
        "zipcode": 98008,
        "lat": 47.5943,
        "long": -122.11,
        "sqft_living15": 3470,
        "sqft_lot15": 18270
    }])
    fn = tmp_path_factory.mktemp("house_data") / "tmp-input-data.csv"
    data.to_csv(fn, index=False)
    return fn


@pytest.fixture(scope="session")
def house_expected_output_file_path(tmp_path_factory):
    data = pd.DataFrame([
        {
            "id": "2025069140",
            "date": "3/17/2015",
            "price": 1900000.0,
            "bedrooms": 3,
            "bathrooms": 2.5,
            "sqft_living": 2830,
            "sqft_lot": 4334,
            "floors": 3.0,
            "waterfront": 1.0,
            "view": 4.0,
            "condition": 3,
            "grade": 10,
            "sqft_above": 2830,
            "sqft_basement": 0,
            "zipcode": 98074,
            "lat": 47.6318,
            "long": -122.071,
            "sqft_living15": 2830,
            "sqft_lot15": 38211,
            "last_known_change": 2006,
            "sqft_price": 265.21,
            "delta_lat": 0.004059999999995512,
            "delta_long": 0.17094000000000165,
            "center_distance": 12.833581809845704,
            "water_distance": 0.0
        },
        {
            "id": "518500480",
            "date": "8/11/2014",
            "price": 3000000.0,
            "bedrooms": 3,
            "bathrooms": 3.5,
            "sqft_living": 4410,
            "sqft_lot": 10756,
            "floors": 2.0,
            "waterfront": 1.0,
            "view": 4.0,
            "condition": 3,
            "grade": 11,
            "sqft_above": 3430,
            "sqft_basement": 980,
            "zipcode": 98056,
            "lat": 47.5283,
            "long": -122.205,
            "sqft_living15": 3550,
            "sqft_lot15": 5634,
            "last_known_change": 2014,
            "sqft_price": 197.81,
            "delta_lat": 0.0994400000000013,
            "delta_long": 0.036940000000001305,
            "center_distance": 11.411082731842676,
            "water_distance": 0.0
        },
        {
            "id": "8043700105",
            "date": "4/17/2015",
            "price": 2300000.0,
            "bedrooms": 4,
            "bathrooms": 4.0,
            "sqft_living": 4360,
            "sqft_lot": 8175,
            "floors": 2.5,
            "waterfront": 1.0,
            "view": 4.0,
            "condition": 3,
            "grade": 10,
            "sqft_above": 3940,
            "sqft_basement": 420,
            "zipcode": 98008,
            "lat": 47.5724,
            "long": -122.104,
            "sqft_living15": 2670,
            "sqft_lot15": 8525,
            "last_known_change": 2007,
            "sqft_price": 183.49,
            "delta_lat": 0.055340000000001055,
            "delta_long": 0.1379400000000004,
            "center_distance": 12.044253818163005,
            "water_distance": 0.0
        },
        {
            "id": "9253900271",
            "date": "1/7/2015",
            "price": 3570000.0,
            "bedrooms": 5,
            "bathrooms": 4.5,
            "sqft_living": 4850,
            "sqft_lot": 10584,
            "floors": 2.0,
            "waterfront": 1.0,
            "view": 4.0,
            "condition": 3,
            "grade": 10,
            "sqft_above": 3540,
            "sqft_basement": 1310,
            "zipcode": 98008,
            "lat": 47.5943,
            "long": -122.11,
            "sqft_living15": 3470,
            "sqft_lot15": 18270,
            "last_known_change": 2007,
            "sqft_price": 231.31,
            "delta_lat": 0.03344000000000591,
            "delta_long": 0.13194000000000017,
            "center_distance": 10.576188229110516,
            "water_distance": 0.0
        }
    ])
    fn = tmp_path_factory.mktemp("house_data") / "tmp-input-data.csv"
    data.to_csv(fn, index=False)
    return fn
